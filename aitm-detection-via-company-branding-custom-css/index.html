<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>AitM detection via company branding custom CSS - vadrwave.ch</title><meta name="description" content="Phishing attempts targeting Microsoft 365 subscribers are rising quickly. Why? Targeting Microsoft is very appealing because it is used by many users and companies. Additionally, methods for getting around Multi-Factor Authentication (MFA) in phishing attacks are becoming more and more common (AiTM phishing attacks). Attackers&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="stylesheet" href="https://blog.vadrwave.ch/media/plugins/syntaxHighlighter/prism-black.css"><link rel="stylesheet" href="https://blog.vadrwave.ch/media/plugins/syntaxHighlighter/prism-inline-color.css"><script async defer="defer" type="gdpr-blocker/analytics" src="https://cloud.umami.is/script.js" data-website-id="79f20ee2-9751-4dd8-897d-3ee577125a18" data-auto-track="true" data-do-not-track="false" data-cache="false"></script><script type="gdpr-blocker/analytics" async src="https://www.googletagmanager.com/gtag/js?id=G-J5XYR8C46R"></script><script type="gdpr-blocker/analytics">window.dataLayer = window.dataLayer || [];
				  function gtag(){dataLayer.push(arguments);}
				  gtag('js', new Date());
				  gtag('config', 'G-J5XYR8C46R' );</script><link rel="canonical" href="https://blog.vadrwave.ch/aitm-detection-via-company-branding-custom-css/"><link rel="alternate" type="application/atom+xml" href="https://blog.vadrwave.ch/feed.xml"><link rel="alternate" type="application/json" href="https://blog.vadrwave.ch/feed.json"><meta property="og:title" content="AitM detection via company branding custom CSS"><meta property="og:image" content="https://blog.vadrwave.ch/media/posts/3/4a6efe57-4b9e-4089-93b5-c7760a7864f2-2.webp"><meta property="og:image:width" content="1024"><meta property="og:image:height" content="1024"><meta property="og:site_name" content="vadrwave.ch"><meta property="og:description" content="Phishing attempts targeting Microsoft 365 subscribers are rising quickly. Why? Targeting Microsoft is very appealing because it is used by many users and companies. Additionally, methods for getting around Multi-Factor Authentication (MFA) in phishing attacks are becoming more and more common (AiTM phishing attacks). Attackers&hellip;"><meta property="og:url" content="https://blog.vadrwave.ch//aitm-detection-via-company-branding-custom-css/"><meta property="og:type" content="article"><link rel="stylesheet" href="https://blog.vadrwave.ch/assets/css/style.css?v=db8649ed47c6ff1626cbe40d1e0db2db"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.vadrwave.ch/aitm-detection-via-company-branding-custom-css/"},"headline":"AitM detection via company branding custom CSS","datePublished":"2024-10-04T17:41","dateModified":"2024-10-04T17:41","image":{"@type":"ImageObject","url":"https://blog.vadrwave.ch/media/posts/3/4a6efe57-4b9e-4089-93b5-c7760a7864f2-2.webp","height":1024,"width":1024},"description":"Phishing attempts targeting Microsoft 365 subscribers are rising quickly. Why? Targeting Microsoft is very appealing because it is used by many users and companies. Additionally, methods for getting around Multi-Factor Authentication (MFA) in phishing attacks are becoming more and more common (AiTM phishing attacks). Attackers&hellip;","author":{"@type":"Person","name":"Roman","url":"https://blog.vadrwave.ch/authors/roman/"},"publisher":{"@type":"Organization","name":"Roman","logo":{"@type":"ImageObject","url":"https://blog.vadrwave.ch/media/website/vadrwave_transparent-.png","height":1200,"width":1200}}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript><link rel="stylesheet" href="https://blog.vadrwave.ch/media/plugins/docSearch/docsearch.min.css"></head><body class="post-template"><header class="top js-header"><a class="logo" href="https://blog.vadrwave.ch/"><img src="https://blog.vadrwave.ch/media/website/vadrwave_transparent-.png" alt="vadrwave.ch" width="1200" height="1200"></a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://blog.vadrwave.ch/about/" target="_self">About</a></li><li><a href="https://blog.vadrwave.ch/tags/intune/" target="_self">Security</a></li></ul></nav><div class="search"><div class="search__overlay js-search-overlay"><div class="wrapper search__overlay-inner"><div id="docsearch"></div></div></div><button class="search__btn btn--icon js-search-btn" aria-label="Search"><svg height="18" width="18" role="presentation" focusable="false"><use xlink:href="https://blog.vadrwave.ch/assets/svg/svg-map.svg#search"/></svg></button></div></header><main class="post"><article class="content"><div class="hero"><header class="hero__content hero__content--centered"><div class="wrapper"><h1>AitM detection via company branding custom CSS</h1><div class="feed__meta content__meta content__meta--centered"><a href="https://blog.vadrwave.ch/authors/roman/" class="feed__author">Roman</a> <time datetime="2024-10-04T17:41" class="feed__date">October 4, 2024</time></div></div></header><figure class="hero__image"><div class="hero__image-wrapper"><img src="https://blog.vadrwave.ch/media/posts/3/4a6efe57-4b9e-4089-93b5-c7760a7864f2-2.webp" srcset="https://blog.vadrwave.ch/media/posts/3/responsive/4a6efe57-4b9e-4089-93b5-c7760a7864f2-2-xs.webp 640w, https://blog.vadrwave.ch/media/posts/3/responsive/4a6efe57-4b9e-4089-93b5-c7760a7864f2-2-sm.webp 768w, https://blog.vadrwave.ch/media/posts/3/responsive/4a6efe57-4b9e-4089-93b5-c7760a7864f2-2-md.webp 1024w, https://blog.vadrwave.ch/media/posts/3/responsive/4a6efe57-4b9e-4089-93b5-c7760a7864f2-2-lg.webp 1366w, https://blog.vadrwave.ch/media/posts/3/responsive/4a6efe57-4b9e-4089-93b5-c7760a7864f2-2-xl.webp 1600w, https://blog.vadrwave.ch/media/posts/3/responsive/4a6efe57-4b9e-4089-93b5-c7760a7864f2-2-2xl.webp 1920w" sizes="88vw" loading="eager" height="1024" width="1024" alt=""></div></figure></div><div class="entry-wrapper content__entry"><p>Phishing attempts targeting Microsoft 365 subscribers are rising quickly. Why? Targeting Microsoft is very appealing because it is used by many users and companies. Additionally, methods for getting around Multi-Factor Authentication (MFA) in phishing attacks are becoming more and more common (AiTM phishing attacks). Attackers can even access accounts that are MFA-protected thanks to this.Â </p><p>But what can we do about that?</p><figure class="post__image post__image--center"><img loading="lazy" src="https://blog.vadrwave.ch/media/posts/3/4a6efe57-4b9e-4089-93b5-c7760a7864f2.webp" alt="" width="487" height="487" sizes="(max-width: 1920px) 100vw, 1920px" srcset="https://blog.vadrwave.ch/media/posts/3/responsive/4a6efe57-4b9e-4089-93b5-c7760a7864f2-xs.webp 640w, https://blog.vadrwave.ch/media/posts/3/responsive/4a6efe57-4b9e-4089-93b5-c7760a7864f2-sm.webp 768w, https://blog.vadrwave.ch/media/posts/3/responsive/4a6efe57-4b9e-4089-93b5-c7760a7864f2-md.webp 1024w, https://blog.vadrwave.ch/media/posts/3/responsive/4a6efe57-4b9e-4089-93b5-c7760a7864f2-lg.webp 1366w, https://blog.vadrwave.ch/media/posts/3/responsive/4a6efe57-4b9e-4089-93b5-c7760a7864f2-xl.webp 1600w, https://blog.vadrwave.ch/media/posts/3/responsive/4a6efe57-4b9e-4089-93b5-c7760a7864f2-2xl.webp 1920w"></figure><p>Its pretty simple ðŸ˜Ž</p><h1>AitM detection via company branding CSS</h1><p><strong>But what does that mean?</strong></p><p>It's evident from the clarion project that HuskyHacks hosts an API using Python Flask. The url() parameter, which acts as a trigger for the detection logic in CSS, is added to invoke this API. This detection logic examines the contents of the received HTTP header's "referer" field. This 'referer' field contains the absolute partial address from which a resource has been requested (meaning, the domain where the user was on when the url() parameter was called in CSS).</p><p>All of this makes sense if we see that a user's account is being logged into a Microsoft login page and the'referer' field does not say 'login.microsoftonline.com,' then we assume that the user was on an AitM site. This is due to the expectation that the Microsoft login page would only be accessible through the website "login.microsoftonline.com.".</p><h2 id="step-1-log-in-to-your-microsoft-tenant">Step 1: Log in to your Microsoft Tenant</h2><p>Open yourÂ  web browser and go to the <a href="https://portal.azure.com/#view/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/~/LoginTenantBranding">Company Branding page</a>Â in the Azure Portal. Login with your tenants administrator account to visit the page.</p><p>If no Company Branding is used within your tenant, click theÂ <strong>Customize</strong>Â button to create it.</p><figure class="post__image"><img loading="lazy" src="https://blog.vadrwave.ch/media/posts/3/2024-10-04-16_54_42-padrunli-Microsoft-Azure-und-1-weitere-Seite-Profil-1-Microsoft-Edge.png" alt="" width="1976" height="838" sizes="(max-width: 1920px) 100vw, 1920px" srcset="https://blog.vadrwave.ch/media/posts/3/responsive/2024-10-04-16_54_42-padrunli-Microsoft-Azure-und-1-weitere-Seite-Profil-1-Microsoft-Edge-xs.png 640w, https://blog.vadrwave.ch/media/posts/3/responsive/2024-10-04-16_54_42-padrunli-Microsoft-Azure-und-1-weitere-Seite-Profil-1-Microsoft-Edge-sm.png 768w, https://blog.vadrwave.ch/media/posts/3/responsive/2024-10-04-16_54_42-padrunli-Microsoft-Azure-und-1-weitere-Seite-Profil-1-Microsoft-Edge-md.png 1024w, https://blog.vadrwave.ch/media/posts/3/responsive/2024-10-04-16_54_42-padrunli-Microsoft-Azure-und-1-weitere-Seite-Profil-1-Microsoft-Edge-lg.png 1366w, https://blog.vadrwave.ch/media/posts/3/responsive/2024-10-04-16_54_42-padrunli-Microsoft-Azure-und-1-weitere-Seite-Profil-1-Microsoft-Edge-xl.png 1600w, https://blog.vadrwave.ch/media/posts/3/responsive/2024-10-04-16_54_42-padrunli-Microsoft-Azure-und-1-weitere-Seite-Profil-1-Microsoft-Edge-2xl.png 1920w"></figure><h2 id="step-2-generate-a-personal-link">Step 2: Generate a personal link</h2><p>In another browser tab, visit the official DSCM website atÂ <a href="https://didsomeoneclone.me/">https://didsomeoneclone.me</a>. Enter the domainÂ <strong>login.microsoftonline.com</strong>Â and your email in the sign-up form, and then wait a few seconds.</p><p>You will receive an email containing your personal link. Click theÂ <strong>Install Instructions</strong>Â button in the email. On the destination page, your personal link is displayed:</p><figure class="post__image"><img loading="lazy" src="https://blog.vadrwave.ch/media/posts/3/Screenshot-2024-10-04-165927.png" alt="" width="965" height="349" sizes="(max-width: 1920px) 100vw, 1920px" srcset="https://blog.vadrwave.ch/media/posts/3/responsive/Screenshot-2024-10-04-165927-xs.png 640w, https://blog.vadrwave.ch/media/posts/3/responsive/Screenshot-2024-10-04-165927-sm.png 768w, https://blog.vadrwave.ch/media/posts/3/responsive/Screenshot-2024-10-04-165927-md.png 1024w, https://blog.vadrwave.ch/media/posts/3/responsive/Screenshot-2024-10-04-165927-lg.png 1366w, https://blog.vadrwave.ch/media/posts/3/responsive/Screenshot-2024-10-04-165927-xl.png 1600w, https://blog.vadrwave.ch/media/posts/3/responsive/Screenshot-2024-10-04-165927-2xl.png 1920w"></figure><h2 id="step-3-create-the-css-template-file">Step 3: Create the CSS template file</h2><p>Now itâ€™s time to create a CSS file. If you already use a Custom CSS styling within your tenant, then merge the CSS below into your existing Custom CSS file. Otherwise, you can simply create a new CSS file with the following content:</p><pre class="language-css line-numbers"><code>.ext-sign-in-box {
  background: white url("&lt;YOURLINK&gt;") center no-repeat;
}</code></pre><p>Make sure to replace theÂ <strong>&lt;YOURLINK&gt;</strong>Â value with the link that you obtained in step 2.</p><h2 id="step-4-upload-the-css-file">Step 4: Upload the CSS file</h2><p>The last step is uploading the file into the Azure Portal. Go back to the page opened at step 1, open theÂ <strong>Layout</strong>Â tab, and navigate to the CSS file using theÂ <strong>Browse</strong>Â button at theÂ <strong>Custom CSS</strong>Â option.</p><figure class="post__image"><img loading="lazy" src="https://blog.vadrwave.ch/media/posts/3/2024-10-04-17_02_52-Customize-default-sign-in-experience-Microsoft-Azure-und-1-weitere-Seite-Pro.png" alt="" width="872" height="959" sizes="(max-width: 1920px) 100vw, 1920px" srcset="https://blog.vadrwave.ch/media/posts/3/responsive/2024-10-04-17_02_52-Customize-default-sign-in-experience-Microsoft-Azure-und-1-weitere-Seite-Pro-xs.png 640w, https://blog.vadrwave.ch/media/posts/3/responsive/2024-10-04-17_02_52-Customize-default-sign-in-experience-Microsoft-Azure-und-1-weitere-Seite-Pro-sm.png 768w, https://blog.vadrwave.ch/media/posts/3/responsive/2024-10-04-17_02_52-Customize-default-sign-in-experience-Microsoft-Azure-und-1-weitere-Seite-Pro-md.png 1024w, https://blog.vadrwave.ch/media/posts/3/responsive/2024-10-04-17_02_52-Customize-default-sign-in-experience-Microsoft-Azure-und-1-weitere-Seite-Pro-lg.png 1366w, https://blog.vadrwave.ch/media/posts/3/responsive/2024-10-04-17_02_52-Customize-default-sign-in-experience-Microsoft-Azure-und-1-weitere-Seite-Pro-xl.png 1600w, https://blog.vadrwave.ch/media/posts/3/responsive/2024-10-04-17_02_52-Customize-default-sign-in-experience-Microsoft-Azure-und-1-weitere-Seite-Pro-2xl.png 1920w"></figure><p>After saving you are good to go! Enjoy you new AiTM Phishing Protection!</p></div><footer class="content__footer"><div class="entry-wrapper"><p class="content__updated">This article was updated on October 4, 2024</p><div class="content__actions"><ul class="content__tag"><li><a href="https://blog.vadrwave.ch/tags/intune/">Security</a></li></ul><div class="content__share"><button class="btn--icon content__share-button js-content__share-button"><svg width="20" height="20" aria-hidden="true"><use xlink:href="https://blog.vadrwave.ch/assets/svg/svg-map.svg#share"></use></svg> <span>Share It</span></button><div class="content__share-popup js-content__share-popup"></div></div></div><div class="content__bio bio"><div><h3 class="h4 bio__name"><a href="https://blog.vadrwave.ch/authors/roman/" rel="author">Roman</a></h3></div></div></div><nav class="content__nav"><div class="wrapper"><div class="content__nav-inner"><div class="content__nav-prev"><a href="https://blog.vadrwave.ch/the-scary-side-of-cybersecurity-halloween-edition/" class="content__nav-link" rel="prev"><div><span>Previous</span> The Scary side of Cybersecurity - Halloween Edition</div></a></div></div></div></nav></footer></article></main><footer class="footer footer--glued"><div class="wrapper"><div class="footer__copyright"><p>Powered by Publii</p></div><button onclick="backToTopFunction()" id="backToTop" class="footer__bttop" aria-label="Back to top" title="Back to top"><svg width="20" height="20"><use xlink:href="https://blog.vadrwave.ch/assets/svg/svg-map.svg#toparrow"/></svg></button></div></footer><script defer="defer" src="https://blog.vadrwave.ch/assets/js/scripts.min.js?v=ffcbea6c02c8178d10092962b235a5b0"></script><script>window.publiiThemeMenuConfig={mobileMenuMode:'sidebar',animationSpeed:300,submenuWidth: 'auto',doubleClickTime:500,mobileMenuExpandableSubmenus:true,relatedContainerForOverlayMenuSelector:'.top'};</script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script><script defer="defer" src="https://blog.vadrwave.ch/media/plugins/syntaxHighlighter/prism.js"></script><script defer="defer" src="https://blog.vadrwave.ch/media/plugins/syntaxHighlighter/prism-line-numbers.min.js"></script><script defer="defer" src="https://blog.vadrwave.ch/media/plugins/syntaxHighlighter/clipboard.min.js"></script><script defer="defer" src="https://blog.vadrwave.ch/media/plugins/syntaxHighlighter/prism-copy-to-clipboard.min.js"></script><script defer="defer" src="https://blog.vadrwave.ch/media/plugins/syntaxHighlighter/prism-inline-color.min.js"></script><script defer="defer" src="https://blog.vadrwave.ch/media/plugins/syntaxHighlighter/prism-autolinker.min.js"></script><script defer="defer" src="https://blog.vadrwave.ch/media/plugins/syntaxHighlighter/prism-show-invisibles.min.js"></script><script src="https://blog.vadrwave.ch/media/plugins/docSearch/docsearch.min.js"></script><script type="text/javascript">docsearch({
				container: '#docsearch',
				appId: '',
				indexName: '',
				apiKey: '',
				debug: false
			});</script></body></html>